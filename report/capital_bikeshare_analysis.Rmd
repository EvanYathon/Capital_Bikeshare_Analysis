---
title: "Top Predictors for Daily Ridership in the Capital Bike Share System"
output: github_document
author: "Mike Yuan and Evan Yathon"
date: "2018-11-24"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_knit$set(root.dir = here::here())
library(tidyverse)
```

Bike sharing systems are increasingly popular in urban centres as an easy and effective way for people to get from one location to another; in the United States, [bike ridership grew](https://nacto.org/bike-share-statistics-2016/) from 320,000 yearly trips in 2010 to 28 million in 2016 <sup>1</sup>.  Weather, temperature and season are some motivators behind the choice to use a bike sharing service for commuting.  Knowing the factors that influence whether a person chooses to rent a bike on a particular day is important to forecast usage and understand drivers behind daily bike rentals.  This is why we chose to investigate the top three predictors of rental bike ridership using the [Capital Bike Share Dataset](https://archive.ics.uci.edu/ml/datasets/bike+sharing+dataset)<sup>2</sup>.

### Exploratory Data Analysis

> What are the top three predictors of rental bike ridership?

To answer this question, we decided to use a decision tree to predict daily ridership, and extract the top three predictors from the fit model.  Our approach required the ridership to be split into categories; below is a histogram visualizing that split.

![Figure 1](img/plot_ridership_histo.png)

###### Figure 1. Histogram of daily bike ridership, separated into thirds.

Figure 1 gives an idea of the daily ridership count from the Capital Bikeshare system in Washington, D.C. over the period of two years.  Our decision was to split daily ridership into equal thirds so that the decision tree would have an equal split of target categories to learn from.  The resulting categories are low, mid and high ridership numbers on a daily basis.

There are many different features in the dataset, including temperature, humidity and weather conditions.

![Figure 2](img/plot_rider_by_date.png)

###### Figure 2. Daily Ridership over the course of two years, coloured by season.  Black dotted line is a 15 point moving average acting as a smoother to observe trends with less noise.

As seen above in figure 2 there is a cyclical trend in the ridership numbers, with decrease in ridership happening in late autumn and winter.  2012 also seems to have significantly higher ridership numbers than 2011.  At first glance it would appear that these features might be have been some of the predictors that we were looking for - it will be interesting to compare the EDA results to those of the decision tree.

### Decision Tree Analysis

![Figure 3](img/dtree.png)

###### Figure 3. Visualization of the final fitted decision tree.

Figure 3 shows the classification steps undertaken by the model to split data into final ridership categories.  Green nodes are classified as Low ridership, purple are mid level ridership and orange are high ridership.  The intensity of the colour represents purity at each location.  The stump is split immediately on the year feature, with more low and mid ridership belonging to 2011 and a higher proportion of high ridership belonging to 2012.  This agrees with we've seen and guessed from figure 2, but what about season?  It would be arduous to examine the entire tree and all decision splits.

![Figure 4](img/important_features.png)

###### Figure 4.  Feature importance rated by Gini Value

Figure 4 shows 

### Critique

## References
1. [Nacto Bike Share Statistic 2016](https://nacto.org/bike-share-statistics-2016/)
2. [Capital Bike Share Dataset](https://archive.ics.uci.edu/ml/datasets/bike+sharing+dataset)
      - Used the `day.csv` dataset.
3. 